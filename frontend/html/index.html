<!DOCTYPE html>
<html lang="en" style="background:#0a0a0a!important; visibility: visible !important;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate - DALMA AI</title>
    
    <!-- CRITICAL: Load coordination script IMMEDIATELY -->
    <script src="/frontend/src/generatePageLoader.js"></script>
    
    <!-- ZERO FLASH: Show content by default, let JS handle transitions -->
    <style>
        /* Prevent white flash - show dark background immediately */
        html, body {
            background: #0a0a0a !important;
            margin: 0 !important;
            padding: 0 !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Page content visible by default - JS will handle transitions */
        .page-content {
            opacity: 1;
            visibility: visible;
            transition: none; /* No transitions for instant reveal */
        }
        
        .page-content.revealed {
            opacity: 1;
        }
        
        /* Ensure no white backgrounds anywhere */
        * {
            background-color: transparent;
        }
        
        /* Override any potential white backgrounds */
        div, section, main, article {
            background-color: transparent !important;
        }
        
        /* REMOVE ARROW FROM ACCOUNT BUTTON - ONLY FOR THIS PAGE */
        .account-btn::after {
            display: none !important;
        }
        
        .account-btn.active::after {
            display: none !important;
        }
        
        /* CRITICAL: Ensure controls sidebar INSTANT appearance */
        .controls-sidebar {
            background: rgba(10, 10, 10, 0.85) !important;
            border: 1px solid rgba(255, 255, 255, 0.15) !important;
            backdrop-filter: blur(8px) !important;
            transform: translateZ(0) !important;
            backface-visibility: hidden !important;
            transition: none !important; /* NO TRANSITIONS */
        }
        
        /* Hide controls until page is revealed */
        .page-content:not(.revealed) .controls-sidebar {
            opacity: 0;
            visibility: hidden;
        }
        
        /* Show controls INSTANTLY when page is revealed - NO ANIMATION */
        .page-content.revealed .controls-sidebar {
            opacity: 1 !important;
            visibility: visible !important;
            transition: none !important; /* Force no transitions */
        }
    </style>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="/frontend/css/styles.css">
    <link rel="stylesheet" href="/frontend/css/homepage.css">
    <link rel="stylesheet" href="/frontend/css/auth-modal.css">
    
    <link rel="icon" href="/frontend/public/favicon.png" type="image/png">
</head>
<body style="background:#0a0a0a!important; visibility: visible !important;">
    
    <!-- All page content - VISIBLE BY DEFAULT -->
    <div class="page-content">
        
        <!-- Geometric Pattern Background (same as homepage) -->
        <div class="geometric-pattern"></div>
        
        <!-- Header -->
        <header class="header">
            <div class="logo-section">
                <a href="homepage.html" class="logo-link">
                    <img src="/frontend/public/logo2dalma.png" alt="Dalma AI Logo" class="logo">
                </a>
            </div>
            <!-- Regular Navigation (Desktop) -->
            <nav class="nav">
                <div class="nav-left">
                  <a href="homepage.html">Home</a>
                    <a href="homepage.html#assets">Assets</a>
                    <a href="#about">About</a>
                    <a href="#rig-animate">Rig & Animate</a>
                    <a href="index.html" class="active">Generate</a>
                    <!-- Admin navigation items will be dynamically added here by JavaScript -->
                </div>
                <div class="nav-right">
                    <button class="account-btn">Account</button>
                    <!-- Account dropdown will be dynamically added here -->
                </div>
            </nav>
            
            <!-- Hamburger Menu (Mobile) -->
            <div class="hamburger" onclick="toggleMobileNav()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            
            <!-- Mobile Navigation -->
            <nav class="mobile-nav" id="mobileNav">
                <a href="homepage.html">Home</a>
                <a href="homepage.html#assets">Assets</a>
                <a href="#about">About</a>
                <a href="#rig-animate">Rig & Animate</a>
                <a href="index.html">Generate</a>
                <button class="account-btn">Account</button>
                <!-- Admin navigation items will be dynamically added here by JavaScript -->
            </nav>
        </header>

        <div class="container">
            <div class="main-layout">
                <!-- Left side - 3D Viewer -->
                <div class="viewer-section">
                    <!-- 3D Viewer - Clean styling, let CSS handle dimensions -->
                    <div id="viewer">
                        <div id="3dCanvas">
                            <div id="dogFactOverlay"></div>
                            <div id="generationOverlay"></div>
                            
                            <!-- Like Button -->
                            <div class="like-button-container" id="likeButtonContainer" style="display: none;">
                                <button class="like-button" id="likeButton" title="Like this model">
                                    <svg class="heart-icon" viewBox="0 0 24 24" width="20" height="20">
                                        <path class="heart-outline" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="none" stroke="currentColor" stroke-width="2"/>
                                        <path class="heart-filled" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="currentColor" opacity="0"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Action buttons (hidden until model loads) -->
                    <div class="action-buttons">
                        <button class="action-btn">
                            <span>ðŸ¦´ Rigging & Animation</span>
                        </button>
                        <button class="action-btn">
                            <span>ðŸš€ Direct Export</span>
                        </button>
                        <!-- Download dropdown -->
                        <div class="download-dropdown">
                            <button class="download-trigger">
                                <span>ðŸ“¥ Download</span>
                                <span class="dropdown-arrow">â–¶</span>
                            </button>
                            <div class="download-options">
                                <button id="downloadGLB" class="download-option">GLB</button>
                                <button id="downloadUSDZ" class="download-option">USDZ</button>
                                <button id="downloadOBJ" class="download-option">OBJ</button>
                                <button id="downloadFBX" class="download-option">FBX</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right side - Controls (INSTANT APPEARANCE) -->
                <div class="controls-sidebar disabled">
                    
                    <!-- Image Upload -->
                    <div class="control-section image-upload">
                        <label class="control-label" for="imageInput">Upload Image</label>
                        <div class="upload-area" onclick="document.getElementById('imageInput').click()">
                            <input type="file" id="imageInput" accept="image/*"/>
                            <div class="upload-text">Supported formats: .jpg .jpeg .png</div>
                            <div class="upload-preview" id="uploadPreview">
                                <div class="upload-preview-overlay">
                                    <div class="upload-change-text">Click to change image</div>
                                </div>
                            </div>
                            <!-- SCANNING OVERLAY -->
                            <div class="scanning-overlay" id="scanningOverlay">
                                <div class="scanning-animation"></div>
                                <div class="scanning-text">Scanning picture...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Symmetry Controls -->
                    <div class="control-section dropdown-section">
                        <label class="control-label">Symmetry</label>
                        <div class="dropdown-control" id="symmetryDropdown">
                            <div class="dropdown-display">
                                <span class="dropdown-label">Symmetry</span>
                                <span class="dropdown-value">Auto</span>
                                <span class="dropdown-arrow">></span>
                            </div>
                            <div class="dropdown-options">
                                <div class="dropdown-option" data-value="auto">Auto</div>
                                <div class="dropdown-option" data-value="on">On</div>
                            </div>
                        </div>
                        <!-- Hidden buttons for compatibility -->
                        <div id="symmetryModeButtons" style="display: none;">
                            <button class="symmetry-btn" data-symmetry="auto">Auto</button>
                            <button class="symmetry-btn" data-symmetry="on">On</button>
                        </div>
                    </div>

                    <!-- Topology Controls -->
                    <div class="control-section dropdown-section">
                        <label class="control-label">Topology</label>
                        <div class="dropdown-control" id="topologyDropdown">
                            <div class="dropdown-display">
                                <span class="dropdown-label">Topology</span>
                                <span class="dropdown-value">Triangles</span>
                                <span class="dropdown-arrow">></span>
                            </div>
                            <div class="dropdown-options">
                                <div class="dropdown-option" data-value="triangle">Triangles</div>
                                <div class="dropdown-option" data-value="quad">Quads</div>
                            </div>
                        </div>
                        <!-- Hidden buttons for compatibility -->
                        <div id="topologyButtons" style="display: none;">
                            <button class="topology-btn" data-topology="triangle">Triangles</button>
                            <button class="topology-btn" data-topology="quad">Quads</button>
                        </div>
                    </div>

                    <!-- Polycount Controls -->
                    <div class="control-section">
                        <div class="polycount-control">
                            <label class="control-label" for="polycountSlider">Polycount</label>
                            <div class="polycount-inputs">
                                <input type="range" id="polycountSlider" min="100" max="300000" value="30000" step="100">
                                <input type="number" id="polycountInput" min="100" max="300000" value="30000" step="100">
                            </div>
                        </div>
                    </div>

                    <!-- Texture Controls -->
                    <div class="control-section dropdown-section">
                        <label class="control-label">Texture</label>
                        <div class="dropdown-control" id="textureDropdown">
                            <div class="dropdown-display">
                                <span class="dropdown-label">Texture</span>
                                <span class="dropdown-value">Yes</span>
                                <span class="dropdown-arrow">></span>
                            </div>
                            <div class="dropdown-options">
                                <div class="dropdown-option" data-value="true">Yes</div>
                                <div class="dropdown-option" data-value="false">No</div>
                            </div>
                        </div>
                        <!-- Hidden buttons for compatibility -->
                        <div id="shouldTextureButtons" style="display: none;">
                            <button class="texture-btn" data-texture="true">Yes</button>
                            <button class="texture-btn" data-texture="false">No</button>
                        </div>
                    </div>

                    <!-- PBR Controls -->
                    <div class="control-section">
                        <div id="pbrButtons" class="checkbox-group">
                            <label for="pbrCheckbox">
                                <input type="checkbox" id="pbrCheckbox" />
                                PBR Enabled
                            </label>
                        </div>
                    </div>

                    <!-- Progress Section - Reserved Space -->
                    <div class="progress-section-container">
                        <div class="progress-section">
                            <div id="spinnerContainer">
                                <div class="spinner"></div>
                                <span id="progressText">0%</span>
                            </div>
                            
                            <!-- Progress Bar -->
                            <progress id="progressBar" value="0" max="100"></progress>
                        </div>
                    </div>

                    <!-- Generate Button -->
                    <button id="generateBtn">Generate Model</button>
                    
                </div>
            </div>
        </div>

        <!-- Save Model Modal -->
        <div id="saveModelModal" class="save-modal" style="display: none;">
            <div class="save-modal-overlay"></div>
            <div class="save-modal-content">
                <div class="save-modal-header">
                    <h2>Save Your Model</h2>
                    <button class="save-modal-close" id="saveModalClose">&times;</button>
                </div>
                <div class="save-modal-body">
                    <p>Give your model a name to save it to your collection:</p>
                    <input type="text" id="modelNameInput" placeholder="Enter model name..." maxlength="50">
                    <div class="save-modal-buttons">
                        <button id="saveModelBtn" class="save-btn">Save Model</button>
                        <button id="cancelSaveBtn" class="cancel-btn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer from Homepage -->
        <footer class="footer">
            <div class="footer-content">
                <!-- Download App Section -->
                <div class="footer-section">
                    <div class="footer-section-header">
                        <h3 class="footer-title">Download Our App</h3>
                        <p class="footer-description">Download the Dalma AI app for Android and IOS</p>
                    </div>
                    <div class="footer-section-content">
                        <div class="footer-spacer"></div>
                        <div class="app-buttons">
                            <a href="about.html#download" class="app-button">
                                <img src="/frontend/public/googleplay.png" alt="Get it on Google Play" class="app-store-img">
                            </a>
                            <a href="about.html#download" class="app-button">
                                <img src="/frontend/public/appstore.png" alt="Download on the App Store" class="app-store-img">
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Center Logo Section -->
                <div class="footer-section footer-center-wrapper">
                    <div class="footer-center">
                        <div class="footer-logo-section">
                            <img src="/frontend/public/logo2dalma.png" alt="Dalma AI" class="footer-logo">
                        </div>
                        <p class="footer-mission">Our purpose is to bring our loyal four footed friend to life from a 2D image to a 3D model</p>
                    </div>
                </div>

                <!-- Useful Links Section -->
                <div class="footer-section">
                    <div class="footer-section-header">
                        <h3 class="footer-title">Useful Links</h3>
                    </div>
                    <div class="footer-section-content">
                        <ul class="footer-links">
                            <li><a href="about.html#referral">Referral Program</a></li>
                            <li><a href="about.html#blog">Blog Posts</a></li>
                            <li><a href="about.html#newsletter">News Letter</a></li>
                            <li><a href="about.html#faq">FAQ</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Follow Us Section -->
                <div class="footer-section">
                    <div class="footer-section-header">
                        <h3 class="footer-title">Follow Us</h3>
                    </div>
                    <div class="footer-section-content">
                        <ul class="footer-links">
                            <li><a href="#facebook">Facebook</a></li>
                            <li><a href="#twitter">Twitter</a></li>
                            <li><a href="#instagram">Instagram</a></li>
                            <li><a href="#youtube">Youtube</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Copyright Section -->
            <div class="footer-bottom">
                <div class="footer-divider"></div>
                <p class="footer-copyright">Copyright 2025 - Dalma AI</p>
            </div>
        </footer>
        
    </div>
    <!-- End page-content wrapper -->

    <!-- Load Three.js and other libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <!-- TensorFlow.js and COCO-SSD for dog detection -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.0.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2/dist/coco-ssd.min.js"></script>
    
    <!-- Load application scripts in correct order -->
    <script src="/frontend/src/auth.js"></script>
    <script src="/frontend/src/accountDropdown.js"></script>
    <script src="/frontend/src/dogfacts.js"></script>
    <script src="/frontend/src/api.js"></script>
    <script src="/frontend/src/objectDetection.js"></script>
    <script src="/frontend/src/flow.js"></script>
    <script src="/frontend/src/main.js"></script>
</body>
</html>